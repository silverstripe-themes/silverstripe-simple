/** ----------------------------------------------------------
 *
 * Contains the main layout of the page and the individual styles. 
 * Acts as the main stylesheet for theme.
 *
 * 		Include your notes or table of contents below....
 *		Include color hex's or values of your grid
 *
 * @author Your Name <email@silverstripe.com>
 * ------------------------------------------------------- */

@import 'variables';
@import 'mixins';
@import 'functions';

/* MAIN LAYOUT */

body {
	margin: 0;
	background: $offWhite;
	min-width: 240px;
	-webkit-text-size-adjust: none;
	font-size: $baseFontSize;
	.ie7 &, .ie8 & {
		min-width: 860px;
	}
}

.main {
	background: $white;
	padding: $grid-y*8 0 $grid-y*12;
	min-height: 300px;
}
.inner {
	max-width: 1100px;
	margin: 0 auto;
	padding: 0 $grid-x*6;
	.ie6 & {
		width: 960px;
	}
}
.content-container {
	float: right;
	width: 73%;
}

.no-sidebar {
	.content-container {
		float: left;
		width:100%;
	}
	aside {
		display: none;
	}
}

aside {
	float: left;
	width: 23%;
	margin-top: 12px;
}



/* HEADER */
.header {
	background: $headerColor;
	.inner {
		padding-top: $grid-y*9;
		position: relative;
		min-height: 72px;
		
		/* Brand */
		.brand, .brand:hover {
			float: left;
			color: $white;
			display: inline-block;
		}
		.brand {
			h1 {
				margin: 0;
				padding: 0;
				font-size: rem(3.7);
				font-family: $sansFontFamily;
				color: $white;
				font-weight: 600;
				font-stretch: normal;
				line-height: rem(3.7); //set the lineheight to be the same as the font size. - not based on $baseLineHeight
			}
			p {
				color: $gray;
				margin: $grid-y*2 0 $grid-y*4;
			}
		}

		/* Search form */
		.search-bar {
			position: absolute;
			right: 28px;
			top: 32px;
			#Search {
				margin: 0;
				padding: 0;
			}
			form input {
				&.text {
					width: 155px;
					padding: 5px 34px 5px 10px;
					color: $gray;
					margin: 0;
					border: none;
					border-radius: 14px;
					background: $white;
				}
				&.action {
					font-size: rem(1.1);
					position: absolute;
					right: 0;
					top: -1px;
					cursor: pointer;
					border: none;
					padding: 5px;
					background: none;
					font-family: $iconFont;
					color: $gray;
					border-radius: 0;
					margin: 0;
				}
				&.active,
				&.action:hover {
					color: $black;
				}
			}
		}
		.search-dropdown-icon {
			display: none
		}
	}
	.search-bar form input:focus,
	textarea:focus {
		outline: none
	}

/* NAVIGATION */
	
	/* Primary navigation */
	.primary ul {
		//float: right; 
		//margin:23px -12px 0 0;
		position:absolute; 
		bottom: 0; 
		right:17px;
		li {
			float: left;
			padding-bottom: $grid-y*3;
			margin: 0 $grid-x;
			position: relative;
			white-space: nowrap;
			a {
				color: $gray;
				font-size: rem(1.15);
				font-family: $baseFontFamily;
				padding: 6px 8px;
				font-weight: bold;
				display: block;
				&:hover {
				    color: $white;
				}
			}
			&.section,
			&.current {
				a {
					color: $white;
				}
				&:after {
					content: '}';
					display: block;
					position: absolute;
					left: 50%;
					margin-left: -7px;
					bottom: -7px;
					font-family: $iconFont;
					font-size: rem(2.3);
					color: $white;
					text-align: center;
					line-height: rem(1.55); //needs to have a specific lineheight that is not based on $baseLineHeight
				}
			}
		}
	}
}

/* When navigation and logo overlap tablet-nav is initialized */

.tablet-nav {
	.header .inner {
		padding-top: $grid-y*4;
		.brand p {
			margin-bottom: 0;
		}
		.primary ul {
			float: left;
			clear: both;
			position: relative;
			margin: 20px 0 0 -13px;
			white-space: nowrap;
			right: auto;
			li {
				white-space: nowrap;
				a {
					@include transition(none);
				}
			}
		}
	}
	.footer .right {
		float: left;
		width: 100%;
	}
}

/* Secondary navigation */
.main {
	.secondary {
		border-bottom: 1px solid $grayLighter;
		h3 {
			font-size: rem(1.55);
			line-height: rem-line-height(1.55);
			color: lighten($gray, 10%);
			margin: 0 0 8px 0;
			font-family: $serifFontFamily;
			font-weight: normal;
		}
		ul {
			padding: 0;
			margin: 0;
			li {
				border-top: 1px solid $grayLighter;
				position: relative;
				list-style-type: none;
				margin-bottom: 0;
				a {
					padding: $grid-y*2 0;
					display: block;
					text-transform: uppercase;
					letter-spacing: 2px;
					font-size: rem(0.85);
					line-height: rem(1.3); //needs to have a specific lineheight that is not based on $baseLineHeight
					color: $grayDarker;
					border-bottom: none;
					font-family: $baseFontFamily;
					.arrow {
						color: $linkColor;
						padding-right: $grid-x;
						display: block;
						font-size: rem(1.15);
						line-height: rem-line-height(1.15);
						position: absolute;
						left: 2px;
						top: 7px;
						@include transition(0.2s);
					}
					&:hover {
						.arrow {
							left: 6px
						}
					}
					.text {
						padding-left: 28px;
						display: block;
					}
				}
				&.current a.current {
					color: $linkColor;
				}
				&.section,
				&.current {
					background-color: $offWhite;
					a {
						color: $black;
					}
				}
			}
		}
		h3 {
			color: lighten($gray, 10%);
		}
	}
}


/* Secondary navigation 2-5 levels deep */
.main {
	.secondary {
		ul {
			ul {
				display: none;
				li a { //Indent all sidebar navigation levels
					padding-left: $grid-x*2;
					.arrow { left: 12px; }
					&:hover .arrow { left: 16px; }
				}
				ul li a {
					padding-left: $grid-x*4;
					.arrow { left: 22px; }
					&:hover .arrow { left: 26px; }
				}
				ul ul li a {
					padding-left: $grid-x*6;
					.arrow { left: 32px; }
					&:hover .arrow { left: 36px; }
				}
				ul ul ul li a {
					padding-left: $grid-x*8;
					.arrow { left: 32px; }
					&:hover .arrow { left: 36px; }
				}
			}
			li.current,
			li.section {
				ul {				/* Only show child pages from selected parent */
					display: block;
					ul {
						display: none;
					}
				}
			}
			li a:hover,
			li.section a:hover,
			li.current a:hover {
				color: $linkColor;
			}
		}
	}
}

/* MIXED */

header,
.main,
#Root,
.search-bar,
header .inner,
footer {
	@include clearFix;
}

.search-bar form input.action,
.header .primary li a,
.footer a {
	@include transition(color, 0.2s); //($type, $time)
}

.footer a.brand {
	color: $grayDarker; 
	margin-left: 0;
	&:hover {
		color: $linkColor;
	}
}

body h1 span.amp {
	font-family: $altSerifFontFamily;
	font-style: italic;
}


/* PAGE SPECIFIC LAYOUT */
/* Homepage */

/* Search Results */	
.typography .searchResults h1 {
	margin-bottom: 0;
	padding-bottom: 0;
	border-bottom: none;
}	

/* TODO: Test search results styles */

.searchResults {
	p.searchQuery {
		margin-bottom: $grid-y*2;
		font-size: rem(1.15);
		font-weight: bold;
	}
	ul#SearchResults {
		padding: 0;
		margin-left: 0;
		border-bottom: 1px solid $grayLighter;
		li {
			border-top: 1px solid $grayLighter;
			padding: $grid-y*4 0;
			list-style-type: none;
		}
		p {
			margin-bottom: $grid-y*2;
		}
	}
	#PageNumbers {
		border-top: 1px solid $grayLighter;
		padding-top: $grid-y*4;
		a {
			padding: 0 $grid-x;
		}
		p {
			float: right
		}
		.pagination {
			float: left
		}
		.next,
		.prev {
			font-size: rem(1.1);
		}
		.next { margin-left: 15px; }
		.prev { margin-right: 15px; }
	}
}

/* FOOTER */
.footer {
	color: lighten($gray, 5%);
	background: lighten($grayLighter, 5%);
	padding: $grid-y*4 0;
	font-size: rem(0.85);
	line-height: rem(1.7); //needs to have a specific lineheight that is not based on $baseLineHeight
	a {
		color: lighten($gray, 5%);
		&:hover {
			color: $linkColor;
		}
	}
	.left {
		float: left;
		color: $black;
		display: block;
		margin-bottom: $grid-y*2;
	}
	.right {
		float: right;
		display: block;
		margin-bottom: $grid-y*2;
	}
	span {
		padding: 0 3px;
		color: lighten($gray, 10%);
	}
	.primary,
	.primary ul {
		display: inline;
		margin: 0;
		padding: 0;
	}
	.primary {
		li {
			display: inline;
			.ie6 &, .ie7 & {
				display: inline;
				zoom: 1;
				margin-right: $grid-x*2;
			}
			&:after {
				padding: 0 3px 0 5px;
				content: '/';
				color: lighten($gray, 5%);
			}
			&:last-child:after {
				content: '';
			}
		}
		.nav-open-button {
			display: none;
		}
		ul#nav .menu-bubble-arrow {
			display: none;
		}
	}
	.arrow {
		padding: 0 8px 0 5px;
		color: $linkColor;
		font-size: $baseFontSize;
	}
}

/* DEVICE & RESPONSIVE LAYOUT */

.header .nav-open-button {
	display: none
}
#media-query-trigger {
	display: none;
	visibility: hidden;
}

@media only screen and (max-width: 960px) { 
	.content img {
		max-width: 97%;
		height: auto;
	}
	.header .primary ul {
		margin-left: -12px;
		-webkit-padding-start: 0px;
	}
}

/* when changing the breakpoint below, change it ito the same value in the script.js file as well */
@media only screen and (max-width: 640px) { 
	body {
		max-width: 640px
	}
	#media-query-trigger {
		visibility: visible
	}

	.header {
		padding: 0px;
		.inner {
			padding: 20px 0 0 0;
			min-height: 0;
			.brand {
				float: none;
				display: inline-block;
				margin-left: 22px;
				margin-bottom: 22px;
				h1 {
					font-size: rem(3.1);
					padding-right: $grid-x*16;
				}
			}
		}
		.primary {
			.nav-open-button {
				font-family: $iconFont;
				font-size: rem(1.55);
				color: $grayLighter;
				z-index: 100;
				width: rem(1.55); // needs to match font size
				height: rem(1.55); // needs to match font size
				position: absolute;
				right: 20px;
				top: 42px;
				display: block;
				cursor: pointer;
			}
			ul {
				z-index: 10;
				position: relative;
				display: none;
				float: left;
				margin: 0 !important;
				padding: 0;
				white-space: normal;
				width: 100%;
				li {
					width: 100%;
					margin: 0 !important;
					float: none;
					background: none;
					position: relative;
					text-shadow: 0 1px $white;
					&:after {
						content: '\003e';
						display: block;
						position: absolute;
						right: 20px;
						top: 0px;
						font-family: $iconFont;
						font-size: rem(1.1);
						line-height: rem(2.9); //needs to have a specific lineheight that is not based on $baseLineHeight
						color: lighten($gray, 5%);
						text-align: center;
						vertical-align: middle;
					}
					a {
						padding: 10px 0 10px 22px;
						font-weight: bold;
						border-bottom: 1px solid lighten($gray, 10%);
						color: $grayDark;
						border-radius: 0 !important;
						background: $grayLighter;
					}
					&.current,
					&.section {
						a {
							color: $grayDarker;
							background-color: $grayLight;
						}
						&:after {
							display: none;
						}
					}
					a:hover {
						color: $black;
					}
				}
			}
		}
	}

	.tablet-nav .header nav.primary ul li {
		padding: 0;
	}

	/* Search Form */
	.search-bar {
		width: 100%;
		position: relative;
		top: 0;
		right: 0;
		display: none;
		padding: $grid-y*4 0;
		margin: $grid-y*16 0 0;
		background-color: $grayLighter;
		form {
			margin: 0;
			width: 100%;
			fieldset {
				padding: 0 18px;
				left: 0;
				right: 0;
				position: relative;
			}
			input {
				&.text {
					width: 93%;
					padding: 8px 7% 8px 0;
					text-indent: $grid-x*3;
					position: relative;
					display: block;
					right: 0;
					left: 0;
					border: 1px solid $grayLighter;
					background: $white;
					font-size: rem(1.3);
				}
				&.action {
					right: 24px;
					top: 2px;
					font-size: rem(1.4);
				}
			}
		}
		div.field {
			margin-bottom: 0;
		}
	}
	.search-dropdown-icon {
		display: block;
		cursor: pointer;
		width: rem(1.55); //needs to match the fontsize
		height: rem(1.55); //needs to match the fontsize
		position: absolute;
		right: 60px;
		top: 44px;
		font-family: $iconFont;
		font-size: rem(1.55);
		color: $offWhite;
		text-align: center;
		line-height: rem(1.55); //needs to be the same as the font size
	}

	/* Main Content */
	.main {
	    padding: $grid-y*4 0 $grid-y*9;
	}
	.content-container,
	aside {
	    width: 100%
	}
		
	.typography {
		h1 {
			font-size: rem(2.3);
			line-height:rem-line-height(2.3);
			margin-bottom: $grid-y*3;
			padding-bottom: $grid-y*2;
		}
		p {
			font-size: rem(1.1);
			line-height: rem-line-height(1.1);
			&.intro {
				font-size: rem(1.45);
				line-height: rem-line-height(1.45);
			}
		}
	}

	.main .inner {
		padding: 0 $grid-x*5;
	}
	/* Secondry Nav */
	.secondary li {
		a {
			line-height: 24px
		}
		.arrow {
			line-height: 26px
		}
	}
	/* Footer */
	.footer .right {
	    float: left;
	    width: 100%;
	}
}

/* Based on HTML5 boilerplate print styles */
@media print { 
	* {
		background: transparent !important;
		color: black !important;
		box-shadow: none !important;
		text-shadow: none !important;
		filter: none !important;
		-ms-filter: none !important;
	}
	a,
	a:visited {
		text-decoration: underline
	}
	a[href]:after {
		content: " (" attr(href) ")";
	}
	abbr[title]:after {
		content: " (" attr(title) ")";
	}

	/*
	* Don't show links for images, or javascript/internal links
	*/

	.ir a:after,
	a[href^="javascript:"]:after,
	a[href^="#"]:after {
		content: "";
	}

	thead {
		display: table-header-group
	}
	tr,
	img {
		page-break-inside: avoid
	}
	img {
		max-width: 100% !important
	}
	pre,
	blockquote {
		border: 1px solid #999;
		page-break-inside: avoid;
	}
	@page {
		margin: 0.5cm;
	}
	p,
	h2,
	h3 {
		orphans: 3;
		widows: 3;
	}

	h2,
	h3 {
		page-break-after: avoid;
	}

	/* Simple theme custom print styles */
	.header,
	.footer,
	.nav-open-button,
	.search-bar,
	.search-dropdown-icon,
	nav.primary {
		display: none;
	}
}